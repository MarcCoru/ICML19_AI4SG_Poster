\documentclass[a0]{tumposter}

\usepackage[english]{babel}

\usepackage{blindtext}

\usepackage{multicol}
\usepackage{amsmath}
\usepackage{graphicx}

% for printing fontsizes
\usepackage{printlen}
\uselengthunit{mm}

\input{preamble.tex}

\usepackage[utf8]{inputenc}

\title{
	Early Classification for Agricultural Monitoring \\ from Satellite Time Series
	}
	
\author{
	Marc Rußwurm, Romain Tavenard, Sebastien Lefevre, Marco Körner
	}

\header{
	Remote Sensing Technology \\
	TUM Department of Civil, Geo and Environmental Engineering \\
	Technical University of Munich
	}
	
\begin{document}
\maketitle

\begin{minipage}[t]{.65\textwidth}
	
	\section{Objective}
	
	
	\begin{tikzpicture}[scale=17]
	\node[label={[name=sat,text height=1.5ex,text depth=.25ex]Satellite Data}, anchor=north](x) at (-1,0){$\M{X} = (\V{x}_0, \V{x}_1, \dots , \V{x}_T)$};
	\node[below=of x, label={[yshift=1.3em, xshift=1.8em, font=\tiny, text=white]below:ESA Sentinel 2 Satellite}](s2){\includegraphics[width=10cm]{images/sentinel2}};
	
	
	\node[below=of s2, text width=13cm](eqbox){
		
		is continuously collected in regular temporal intervals.
	};
	
	\node[label={[name=cm,text height=1.5ex,text depth=.25ex]{\color{ecolor}Early} {\color{ccolor}Classification} Model}, anchor=north](f) at (0,0){ $\yhat, {\color{tumbluedark}\deltat} = f(\xuptot)$};
	\node[below=of f](example){\input{images/example.tikz}};
	
	
	\node[label={[name=ctm,text height=1.5ex,text depth=.25ex]Crop Type Labels}, anchor=north](y) at (1,0){
		$\V{y} = \small (y_\text{corn}, y_\text{barley}, \dots) \in \mathbb{R}^{13}$
	};
	\node[below=of y, label=below:IGN crop type labels](labels){\includegraphics[width=9cm]{images/parcels}};
	\node[below=of labels, text width=9cm](lbls){
		\small
		\begin{itemize}\setlength\itemsep{.1em}
		\item European Common Agricultural Policy (CAP)
		\item collected yearly in entire Europe
%		\item slowly made publicly available
%		\item today, gathered on a national basis
%		\item in future harmonized within Europe's INSPIRE directive
		\end{itemize}
	};
	
	\draw[thin, -{Stealth[scale=.5]}, tumblue] (x) -- (f);
	\draw[thin, -{Stealth[scale=.5]}, tumblue] (f) -- (y);
	
	\scoped[on background layer]
	{
		\node[fit=(ctm)(lbls), fill=tumbluelight!20, inner sep=1em, rounded corners]{};
%		\node[fit=(cm)(foodsec), fill=tumorange!20, inner sep=1em, rounded corners]{};
		\node[fit=(sat)(eqbox), fill=tumbluelight!20, inner sep=1em, rounded corners]{};
	}	
	
	\end{tikzpicture}
	
	
	\section{Method}
	
	
%	
	%A network output to indicate a probability of stopping $\deltat$
	
	\begin{minipage}[t]{.49\textwidth}
		\subsection{Mechanism}
		
		\input{images/backprop_stopping_rule.tikz}
		\backpropstoppingrulefull
		
%	\begin{tikzpicture}
%		\node[fill=tumbluelight!20, rounded corners](a) at (0,0){
%						\input{images/backprop_stopping_rule.tikz}
%						\backpropstoppingrulefull
%					};
%		\node[right=of a]{\input{images/qualitative_example.tikz}};
%	\end{tikzpicture}
%	\vspace{-10em}

%	probability of not having classified before (known at training time)
%	$$P(t) = \deltat \cdot \prod_{\tau=0}^{t-1} 1 - p_\tau$$

	

	\end{minipage}
	\begin{minipage}[t]{.49\textwidth}
		
	
	\subsection{Loss function}
	
	composite loss function
	$$\mathcal{L}(\V{x}, \V{y}) = \sum_{t=0}^T P(t;\deltauptot) \mathcal{L}_t(\xuptot, \V{y})$$
	
	
	A Loss function including accuracy and earliness
	
	\begin{tikzpicture}[node distance=-.5em, draw=tumbluelight, rounded corners]
	
	%	\node(allloss){$\mathcal{L}(\V{x}, \V{y}) = \sum_{t=0}^T P(t;\deltauptot) \mathcal{L}_t(\xuptot, \V{y})$};
	%	
	\node(loss){$\mathcal{L}_t(\xuptot, \V{y} ; \alpha)$};
	\node[right=of loss](equals){$=$};
	\node[right=of equals, fill=accuracycolor!20, rounded corners, label={[font=\small]Classification Loss}](classificationloss){$\alpha \mathcal{L}_c (\xuptot, \V{y})$};
	\node[right=of classificationloss](minus){$-$};
	\node[right=of minus, fill=earlinesscolor!20, rounded corners, label={[font=\small]Earliness Reward}](earlinessreward){$(1 - \alpha)\mathcal{R}_e(t, \ycorrect_t)$};
	
	\node[below=1em of classificationloss, text width=10cm, xshift=-4em](clossexp){$\mathcal{L}_c = -\log(\ycorrect_t)$ \\
		\vspace{.5em} 
		\tiny
		cross entropy loss for accurate classifications \par};
	
	\node[below=1em of earlinessreward, text width=13cm, xshift=-2em](erewardexp){$\mathcal{R}_e(t, \ycorrect_t) = \ycorrect_t \left(1 - \frac{t}{T}\right)$ \\
		\vspace{.5em}
		\tiny
		reduces loss for earlier classifications $1-\frac{t}{T}$ if the correct class $\ycorrect_t$ has been predicted with a high score \par};
	
	\draw[thick] (classificationloss) -- (clossexp);
	\draw[thick] (earlinessreward) -- (erewardexp);
	\end{tikzpicture}
	
	
	\end{minipage}


	
	\section{Application}
	Early Crop Type Identification in Agriculture
	
\end{minipage}
\hfill
\begin{minipage}[t]{.32\textwidth}
	\section{Results}
	
	\input{images/loss-accuracyplots.tikz}
	\figearlyreward

	\subsection{Qualitative Example}
	
	
	
	\subsection{Parameterizing stopping times during training}
	
	
	\input{images/trainingstoppingclasses.tikz}
	
	\subsection{Balancing Earliness and Accuracy}
	\begin{table}
		
		\scriptsize
		\hspace{0em}\begin{tabular}{lcccccc}
			\toprule\small
			\textbf{$\alpha$} & accuracy & $\meantstop$  & precision & recall & $f_1$ & $\kappa$ \\
			\cmidrule(lr){0-0}\cmidrule(lr){1-1}\cmidrule(lr){2-2}\cmidrule(lr){3-3}\cmidrule(lr){4-4}\cmidrule(lr){5-5}\cmidrule(lr){6-6}\cmidrule(lr){7-7}
			.0 & .25 $\pm$ .22 & .10 $\pm$ .17 & .19 $\pm$ .20 & .25 $\pm$ .17 & .16 $\pm$ .20 & .12 $\pm$ .19 \\
			.2 & .81 $\pm$ .03 & .40 $\pm$ .02 & .70 $\pm$ .01 & .74 $\pm$ .01 & .71 $\pm$ .01 & .71 $\pm$ .04 \\
			.4 & .80 $\pm$ .09 & .47 $\pm$ .03 & .71 $\pm$ .02 & .74 $\pm$ .01 & .71 $\pm$ .02 & .71 $\pm$ .10 \\
			.6 & .85 $\pm$ .02 & .88 $\pm$ .07 & .73 $\pm$ .04 & .74 $\pm$ .03 & .73 $\pm$ .03 & .77 $\pm$ .03 \\
			.8 & .84 $\pm$ .01 & .93 $\pm$ .05 & .72 $\pm$ .02 & .75 $\pm$ .01 & .73 $\pm$ .02 & .76 $\pm$ .02 \\
			1.0 & .83 $\pm$ .03 & 1.00 $\pm$ .00 & .72 $\pm$ .03 & .75 $\pm$ .01 & .72 $\pm$ .03 & .75 $\pm$ .04 \\
			\bottomrule
		\end{tabular}
		%	\caption{Varying the weighting factor $\alpha$ for \emph{early reward} loss formulation (\cref{sec:earlynessreward}).}
		%	\label{tab:alpha}
		
	\end{table}
	
	\subsection{Classboxplots}
	
	\input{images/classboxplots.tikz}
	
\end{minipage}

% footer environment places \hfill and sets fontsize
\begin{footer}
	\begin{multicols}{2}
		\textbf{Technical University of Munich}\\
		TUM Department of Civil, Geo and Environmental Engineering \\
		Remote Sensing Technology, Computer Vision Research Group \\
		Arcisstr. 21, 80333 Munich, Germany \\
		www.lmf.bgu.tum.de/vision
	\vfill\columnbreak
	%right
		\textbf{Authors} \\
		Marc Rußwurm, Technical University of Munich, Chair of Remote Sensing Technology \\
		Romain Tavenard, IRISA, LETG-Rennes \\
		Sebastien Lefevre, UBS IRISA Obelix  \\
		Marco Körner, Technical University of Munich, Chair of Remote Sensing Technology
	\vfill
	\end{multicols}
\end{footer}

\end{document}